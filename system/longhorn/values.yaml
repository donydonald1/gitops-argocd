longhorn:
  persistence:
    defaultClass: true
    defaultFsType: ext4
  preUpgradeChecker:
    jobEnabled: true
    upgradeVersionCheck: true
  defaultSettings:
    defaultDataPath: "/var/longhorn"
    # This tells Longhorn to use the 'longhorn' bucket of our S3.
    backupTarget: s3://longhorn@us-east-1/longhorn
    # The secret where the MinIO credentials are stored.
    backupTargetCredentialSecret: minio-secret
    # Performance tuning
    defaultReplicaCount: 3
    # Storage performance settings
    storageMinimalAvailablePercentage: 15
    storageOverProvisioningPercentage: 100
    # Replica auto-balance for even distribution
    replicaAutoBalance: best-effort
    # Faster volume attachment
    replicaSoftAntiAffinity: true
    replicaZoneSoftAntiAffinity: true
    # Pod deletion policy for faster recovery
    nodeDownPodDeletionPolicy: delete-both-statefulset-and-deployment-pod
    # Concurrent rebuild limits
    concurrentReplicaRebuildPerNodeLimit: 5
    concurrentVolumeBackupRestorePerNodeLimit: 5
    # Engine upgrade settings
    autoSalvage: true
    autoDeletePodWhenVolumeDetachedUnexpectedly: true
    # Faster snapshot creation
    snapshotDataIntegrityImmediateCheckAfterSnapshotCreation: false
    # Guaranteed engine manager CPU
    guaranteedInstanceManagerCPU: 15
  ingress:
    enabled: true
    ingressClassName: nginx
    host: longhorn.ops.techsecom.io

    tls: enabled
    tlsSecret: longhorn.local-tls

    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      external-dns.alpha.kubernetes.io/enabled: "true"
